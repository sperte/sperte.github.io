<!DOCTYPE html>

<html>

<head>

	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<title>The Making of Version 3: Homepage</title>
	
	<link rel="alternate" type="application/rss+xml" title="RSS" href="/feed" />
	<link rel="shortcut icon" href="/favicon.ico" />
	
	<link rel="stylesheet" href="/css/geekandmild.css" />  

	<script type="text/javascript" src="http://use.typekit.com/hiv0gya.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<script type="text/javascript" src="https://raw.githubusercontent.com/toddmotto/fluidvids/master/src/fluidvids.js"></script>

</head>


<body class="default">

	<header>
		<h1><a href="/">Geek &amp; Mild by Sean Sperte</a></h1>		
	</header>

	<article>
	<h2>The Making of Version 3: Homepage</h2>
	<p>My favorite ExpressionEngine customization on Geek &amp; Mild is found on the homepage; the displaying of article and link entries. They&#8217;re both listed chronologically, as you can see, but are displayed uniquely. Out of the box the <code>&#123;exp:weblog:entries&#125;</code> tag doesn&#8217;t have a <code>category_id</code> variable, so I have to query the database to get one. Thankfully <abbr title="ExpressionEngine">EE</abbr> does have a query tag so no PHP code is needed. 
Here&#8217;s what I do:</p>

<ol class="code">
<li>&#123;exp:weblog:entries weblog=&quot;myblog&quot; limit=&quot;20&quot; paginate=&quot;bottom&quot;&#125;</li>
<li>&#123;exp:query sql=&quot;SELECT cat_id AS mycategory FROM exp_category_posts WHERE entry_id = &apos;&#123;entry_id&#125;&apos;&quot;&#125;</li>
<li>&#123;if mycategory == &apos;#&apos;&#125;</li>
<li>&lt;div class=&quot;link&quot;&gt;</li>
<li>    &#123;if summary&#125;&#123;summary&#125;&#123;if:else&#125;&#123;body&#125;&#123;/if&#125;</li>
<li>&#123;if:else&#125;&lt;div class=&quot;post&quot;&gt;</li>
<li>    &lt;h2&gt;&lt;em&gt;&#123;entry_date format=&quot;%M %j%S&quot;&#125; &lt;/em&gt;&lt;a href=&quot;/entry/&#123;url_title&#125;&quot;&gt;&#123;title&#125;&lt;/a&gt;&lt;/h2&gt;</li>
<li>    &#123;summary&#125;</li>
<li>    &#123;if body&#125;&#123;body&#125;&#123;/if&#125;</li>
<li>    &lt;p class=&quot;post-links&quot;&gt;&lt;a href=&quot;/entry/&#123;url_title&#125;#comments&quot;&gt;&#123;comment_total&#125; comment&#123;if comment_total != &apos;1&apos;&#125;s&#123;/if&#125;&lt;/a&gt;&lt;span&gt; | &lt;/span&gt;&lt;a href=&quot;/entry/&#123;url_title&#125;&quot;&gt;permalink&lt;/a&gt;&lt;/p&gt;</li>
<li>&#123;/if&#125;</li>
<li>&lt;/div&gt;</li>

<li>&lt;hr /&gt;</li>

<li>&#123;paginate&#125;&lt;p id=&quot;pagination&quot;&gt;&#123;if next_page&#125;&lt;span&gt;&lt;a href=&quot;&#123;auto_path&#125;&quot;&gt;&amp;#171; Previous entries&lt;/a&gt;&lt;/span&gt; &#123;/if&#125;&#123;if previous_page&#125;&lt;a href=&quot;&#123;auto_path&#125;&quot;&gt;Newer entries &amp;#187;&lt;/a&gt;&#123;/if&#125;&lt;/p&gt;&#123;/paginate&#125;</li>

<li>&#123;/exp:query&#125;</li>
<li>&#123;/exp:weblog:entries&#125;</li>
</ol>

<p>Firstly, everything&#8217;s wrapped in the <code>&#123;exp:weblog:entries&#125;</code> tag, allowing 20 entries (regardless of entry type, or category), and pagination is set at the bottom. Pretty simple and standard. If you plan on implementing or testing this code block out for your own, just replace the &#8220;myblog&#8221; value with your own blog short-name.</p>

<p>Line 2 is where the query magic happens:</p>

<ol class="code">
<li>&#123;exp:query sql=&#8221;SELECT cat_id AS mycategory FROM exp_category_posts WHERE entry_id = &#8216;&#123;entry_id&#125;&#8217;&#8221;&#125;</li>
</ol>

<p>Here I&#8217;m grabbing the category ID (<code>cat_id</code>) from the table <code>exp_category_posts</code> for each entry and naming it <code>mycategory</code>. After that I have that precious variable <code>&#123;mycategory&#125;</code> available to me.</p>

<p>Note: I think if multiple categories have been assigned to an entry, every ID will be listed when the variable is parsed. So, for instance, if categories 5, 11, and 14 have been selected, the <code>&#123;mycategory&#125;</code> variable will render <code>51114</code>. I&#8217;m not sure about that since I&#8217;m careful to only assign one category for each of my entries, but you should know if you plan on trying this out yourself.</p>

<p>Now that I have the category ID available as a variable, I use a conditional statement to display entries based on their categories. That&#8217;s where the first <code>if</code> comes into play. My &#8220;links&#8221; category ID happens to be 21, so my conditional looks like:</p>

<ol class="code">
<li>&#123;if mycategory == &#8216;21&#8217;&#125;Content for links&#123;if:else&#125;Content for other types of entries&#123;/if&#125;</li>
</ol>

<p>Simple, eh? Once the initial query is done, the rest &#8230; <a href="http://www.silvermac.com/scrolls-like-butter/" title="Scrolls like butter reference">scrolls like butter</a>, as Steve would say.</p>

<p>One other note about my homepage code: You&#8217;ll notice I don&#8217;t use <code>&#123;url_title_path&#125;</code> for any of my entry links. I opted against that based on the simplicity of my website and the fact that linking to a specific anchor (e.g. #comments) doesn&#8217;t work that well when using the <abbr title="ExpressionEngine">EE</abbr> path variables. I&#8217;ll gladly change my ways if someone can explain to me why that is or how to avoid it.</p>

<p><strong>UPDATE</strong>: It&#8217;s like pulling teeth to get EE to <em>not</em> parse code in this entry! Until I can get it worked out, I&#8217;ve added &#8220;VARIABLE&#8221; to the category ID tag.</p>

<p><strong>UPDATE 2</strong>: I&#8217;ve changed the variable name altogether.</p>

<p><strong>UPDATE 3</strong>: Sorry for the outage all day! That&#8217;s what I get for messing around with templates during lunch break. Showing EE code blocks when using the Markdown plugin is proving <a href="http://www.pmachine.com/forums/viewthread/41449/" title="ExpressionEngine Forum thread">more trouble than it&#8217;s worth</a>, but I&#8217;ve been getting help from the pMachine Ninjas. Until a proper solution is found, the code blocks above will be backslash-escaped and have some parsed variables (on the homepage). Best not to copy/paste; just ask me if you want the original source.</p>

<p><strong>UPDATE 4</strong>: Finally got it working! I was provided a new version of the Markdown plugin (much thanks to <a href="http://www.pmachine.com/member/4359/" title="Paul Burdick">Paul Burdick</a>) that encodes EE tags and doesn&#8217;t allow them to be parsed when inside an entry. Certain tags on my homepage still get parsed somehow (notice the <code>&#123;url_title&#125;</code> and <code>&#123;entry_date&#125;</code> tags) because I&#8217;m using query. I&#8217;m not sure if there&#8217;s a way around that, so I am considering other solutions for displaying linked entries versus other types.</p>

<article>
	<footer>
	<small>Site by Sean Sperte, please don't steal. <a href="/about">More info</a>.<br />
	Handcrafted using <a href="http://www.sublimetext.com/">Sublime Text</a>, powered by <a href="http://jekyllrb.com/">Jekyll</a> and hosted on <a href="https://pages.github.com/">Github Pages</a>.</small>
</footer>


</body>

</html>